<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 快排（二） · TuzK1ss' Home</title><meta name="description" content="快排（二） - Tuzk1ss"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://www.tuzkiss.com/atom.xml" title="TuzK1ss' Home"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/tuzkiss" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/tuzkiss" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/resume.html" target="_self" class="nav-list-link">RESUME</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">快排（二）</h1><div class="post-info">Dec 29, 2015</div><div class="post-content"><p>今天在看到排序的时候突然想到自己很久没复习算法了，就随手把快排的算法写了一遍。</p>
<h4 id="最基本的代码如下："><a href="#最基本的代码如下：" class="headerlink" title="最基本的代码如下："></a>最基本的代码如下：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">var quickSort = function (arr) &#123;</div><div class="line"></div><div class="line">    var len = arr.length, </div><div class="line">        val = arr[0],</div><div class="line">        left = [],</div><div class="line">        right = [];</div><div class="line"></div><div class="line">    if (len &lt;= 1) &#123;</div><div class="line">        return arr;</div><div class="line">    &#125;   </div><div class="line"></div><div class="line">    for (var i = 1; i &lt; len; i ++) &#123;</div><div class="line"></div><div class="line">        if (arr[i] &lt; val) &#123;</div><div class="line">            left.push(arr[i]);</div><div class="line">        &#125; else &#123;</div><div class="line">            right.push(arr[i]);</div><div class="line">        &#125;   </div><div class="line">    &#125;</div><div class="line"></div><div class="line">    return arguments.callee(left).concat(val, arguments.callee(right));</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>这段代码中用到了arguments.callee， 之前在看《JS高程》的时候看到，觉得有时候还是蛮有用的。<br>arguments.callee指向的是该函数，这样就可以随意更改quickSort的函数名而不影响正常的运行。<br>但是，这样存在一个小问题，就是在严格模式下无法使用arguments.callee。。。</p>
<p>上述是最基本的快排代码，跟默认的array.sort原理差不多，类似与下列代码，但是数据越大时快排的优势就体现出来了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">var arr = [2, 1, 3, 4, 0];</div><div class="line"></div><div class="line">arr.sort(function (a, b) &#123;</div><div class="line">    return a - b;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>但是这样只能排序一个数值数组，如果是一个object-array呢？ 那么先从简单的开始改写： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">var objArr = [</div><div class="line">    &#123; id : 2, name : &apos;tuzkiss&apos; &#125;,</div><div class="line">    &#123; id : 1, name : &apos;john&apos; &#125;,</div><div class="line">    &#123; id : 3, name : &apos;eric&apos; &#125;,</div><div class="line">    &#123; id : 4, name : &apos;tom&apos; &#125;,</div><div class="line">    &#123; id : 0, name : &apos;cherry&apos; &#125;</div><div class="line">];</div><div class="line"></div><div class="line">objArr.sort(function (a, b) &#123;</div><div class="line">    return a.id - b.id;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>上述代码中改写了sort中传入的函数返回，即带上了需要比较的key（”id”）, 控制台中输出如下：</p>
<p><img src="https://cloud.githubusercontent.com/assets/5539512/12029196/b894b908-ae1f-11e5-9f57-01897ce86987.png" alt="image"></p>
<h4 id="那么？-怎么改写快排呢？让它也支持对象排序呢？"><a href="#那么？-怎么改写快排呢？让它也支持对象排序呢？" class="headerlink" title="那么？ 怎么改写快排呢？让它也支持对象排序呢？"></a>那么？ 怎么改写快排呢？让它也支持对象排序呢？</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">var quickSort = function (arr, key) &#123;</div><div class="line"></div><div class="line">    var len = arr.length, </div><div class="line">        val = arr[0],</div><div class="line">        left = [],</div><div class="line">        right = [];</div><div class="line"></div><div class="line">    if (len &lt;= 1) &#123;</div><div class="line">        return arr;</div><div class="line">    &#125;   </div><div class="line"></div><div class="line">    for (var i = 1; i &lt; len; i ++) &#123;</div><div class="line"></div><div class="line">        if (!key) &#123;</div><div class="line">            if (arr[i] &lt; val) &#123;</div><div class="line">                left.push(arr[i]);</div><div class="line">            &#125; else &#123;</div><div class="line">                right.push(arr[i]);</div><div class="line">            &#125;</div><div class="line">        &#125; else &#123;</div><div class="line"></div><div class="line">            if (arr[i][key] &lt; val[key]) &#123;</div><div class="line">                left.push(arr[i]);</div><div class="line">            &#125; else &#123;</div><div class="line">                right.push(arr[i]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    return arguments.callee(left).concat(val, arguments.callee(right));</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>添加了一个参数key，用于传递是否要比较对象中的某个key，如果key参数存在的话，则按照对象数组的方式去比较。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">quickSort(objArr, &apos;id&apos;);</div></pre></td></tr></table></figure>
<p>输出跟上面的图片是一样。</p>
<h4 id="然后你说，你想测试下性能？-行啊-接着看"><a href="#然后你说，你想测试下性能？-行啊-接着看" class="headerlink" title="然后你说，你想测试下性能？ 行啊~ 接着看"></a>然后你说，你想测试下性能？ 行啊~ 接着看</h4><p>先创建一个随机生成数组的函数，可以传入数组个数的函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">var count = 100;</div><div class="line"></div><div class="line">var createArr = function (count) &#123;</div><div class="line">    var arr = [];</div><div class="line">    for (var i = 0 ; i &lt; count ; i ++) &#123;</div><div class="line">        arr.push(Math.floor(Math.random() * 1000));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    return arr;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">var arr = createArr(count);</div></pre></td></tr></table></figure>
<p>结果如下图：<br><img src="https://cloud.githubusercontent.com/assets/5539512/12029246/fc51b44c-ae20-11e5-92f3-42352fb9ebe9.png" alt="image"></p>
<p>稍后有空再补上</p>
</div></article></div></main><footer><div class="paginator"><a href="/2015/12/30/project/build-tools/webpack-first-experience/" class="prev">PREV</a><a href="/2015/12/26/project/front-end/bind-events/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2017 <a href="http://www.tuzkiss.com">Tuzk1ss</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/tuzkiss/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>